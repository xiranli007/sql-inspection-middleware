Django SQL Middleware for Query Performance Optimization

This Django middleware helps developers improve database performance by logging, analyzing, and flagging inefficient SQL queries generated by Django's ORM. It detects common performance issues, such as slow queries, duplicate queries, expensive joins, and potential N+1 problems, making it easier to optimize database interactions during development.
Features:

    Query Logging: Captures and logs all SQL queries executed during each request for easy analysis.
    Slow Query Detection: Automatically flags and logs queries that exceed a customizable execution time threshold.
    Duplicate Query Detection: Identifies and logs duplicate SQL queries, helping to reduce redundant database calls.
    Expensive JOIN Detection: Flags queries with an excessive number of JOIN statements, allowing developers to optimize complex queries.
    N+1 Problem Detection: Detects potential N+1 query problems by analyzing similar query patterns and logging occurrences.
    SQL Formatting: Formats SQL queries in a readable structure for better understanding and debugging.

Installation:

bash

pip install abb-sql-tools-v2 er

Usage:

    Add the middleware to your MIDDLEWARE setting in settings.py:

    python

MIDDLEWARE = [
    ...
    'path.to.SQLMiddleware',  # Add this line
]

Ensure DEBUG mode is enabled in your Django settings for the middleware to function:

python

    DEBUG = True

    Adjust the customizable thresholds for slow queries, expensive joins, and N+1 detection as needed.

Configuration:

This middleware is designed for development environments (with DEBUG = True) and writes SQL performance logs to a file (sql_middleware.log) for easy review.